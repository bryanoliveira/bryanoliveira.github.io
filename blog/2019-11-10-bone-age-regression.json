{"html":"<p>This is my code for the <a href=\"https://www.kaggle.com/c/bone-age-regression\">I2A2 Bone Age Regression competition</a>. I learned a lot by building this pipeline from scratch and experimenting with different model architectures and optimizers. This was my first end-to-end image regression model, and it was very nice seeing my theoretical knowledge work in practice.</p>\n<p>This competition was inspired by <a href=\"https://www.kaggle.com/kmader/rsna-bone-age\">RSNA&#39;s Bone Age challenge</a>, in which given hand X-ray images, the model should predict the patient&#39;s bone age.</p>\n<div align=\"center\">\n<img src=\"https://github.com/bryanoliveira/bone-age-regression/raw/master/docs/ex1.png\" width=\"230\" height=\"320\">\n<img src=\"https://github.com/bryanoliveira/bone-age-regression/raw/master/docs/ex2.png\" width=\"230\" height=\"320\">\n<img src=\"https://github.com/bryanoliveira/bone-age-regression/raw/master/docs/ex3.png\" width=\"230\" height=\"320\">\n</div>\n\n<blockquote>\n<p>X-ray images provided in the competition&#39;s dataset.</p>\n</blockquote>\n<p>My final solution used a <a href=\"https://arxiv.org/abs/1512.03385\">ResNet50</a> architecture, a <a href=\"https://arxiv.org/abs/1908.03265\">Rectified Adam</a> optimizer and geometric data augmentations. This model achieved a Mean Average Error of 13.2 after 20 epochs of training, which I believe could be improved given more training time and a better preprocessing pipeline (e.g. using object detection to segment the hands and normalizing hand rotation). Unfortunately, I didn&#39;t save all the hyperparameters I experimented with (neither their results), but you&#39;ll find the ones I used for my last submission in the code.</p>\n<p>I used <a href=\"https://www.tensorflow.org/tensorboard\">tensorboard</a> to log the training curves and <a href=\"https://github.com/tqdm/tqdm\">tqdm</a> to track progress. I also used <a href=\"https://github.com/bryanlincoln/fcm-notifier\">FCMNotifier</a>, a tool I made to send logs as notifications to my phone.</p>\n<h2 id=\"requirements\">Requirements</h2>\n<p>See <a href=\"https://github.com/bryanlincoln/bone-age-regression/blob/master/requirements.txt\">requirements.txt</a>.</p>\n<h2 id=\"usage\">Usage</h2>\n<ul>\n<li>  Download the requirements with <code>pip install -r requirements.txt</code></li>\n<li>  Download the dataset and sample submission with <code>sh download_data.sh</code>. You may need to log in with your Kaggle account in order to do it.</li>\n<li>  Train the ResNet50 model with <code>python boneage.py</code></li>\n<li>  Try different models and hyperparameters by editing the training script or use the <code>boneage.ipynb</code> notebook to do it interactively.</li>\n</ul>\n<h2 id=\"credits\">Credits</h2>\n<p>I used the vision models already <a href=\"https://github.com/pytorch/vision/tree/master/torchvision/models\">implemented in torchvision</a> with slight changes. You can try other torchvision models by adding the <code>in_channels</code> parameter to generalize the number of input channels since torchvision models work with RGB images.</p>\n","readingTime":"2 min read","title":"Bone Age Regression","slug":"2019-11-10-bone-age-regression","date":"2019-11-10","urls":[{"cta":"Code","url":"https://github.com/bryanoliveira/bone-age-regression"}],"type":"Deep Learning","tags":["project","ai","deeplearning"],"image":"/img/bone.png","description":"This is my code for the <a href=\"https://www.kaggle.com/c/bone-age-regression\">I2A2 Bone Age Regression competition</a>. I learned a lot by building this pipeline from scratch and experimenting with different model architectures and optimizers. This was my first end-to-end image regression model, and it was very nice seeing my theoretical knowledge work in practice."}